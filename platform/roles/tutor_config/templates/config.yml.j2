# Tutor configuration - Generated by Ansible from config.yml.j2
# Based on variables in platform/inventory.ini

# Platform settings
LMS_HOST: {{ lms_host }}
CMS_HOST: {{ cms_host }}
SECRET_KEY: ## TUTOR_SECRET_KEY ##   # Let Tutor generate this on first save
DEFAULT_FROM_EMAIL: {{ default_from_email }}
{% if forum_host is defined %}
FORUM_HOST: {{ forum_host }}
{% endif %}

# Kubernetes specific settings
K8S_NAMESPACE: {{ k8s_namespace }}

# HTTPS settings
{% if enable_https | bool %}
ENABLE_HTTPS: true
HTTPS_EMAIL: {{ account_email }}
{% else %}
ENABLE_HTTPS: false
{% endif %}

# Object Storage (MinIO plugin usually handles this if enabled)
# AWS_ACCESS_KEY_ID: ## TUTOR_AWS_ACCESS_KEY_ID ##
# AWS_SECRET_ACCESS_KEY: ## TUTOR_AWS_SECRET_ACCESS_KEY ##
# AWS_STORAGE_BUCKET_NAME: "tutor"

# Resource allocations (optional overrides)
{% if k8s_lms_replicas is defined %}
K8S_LMS_REPLICAS: {{ k8s_lms_replicas }}
{% endif %}
{% if k8s_cms_replicas is defined %}
K8S_CMS_REPLICAS: {{ k8s_cms_replicas }}
{% endif %}
{% macro resource_block(service_prefix) -%}
{%   if lookup('vars', 'k8s_' + service_prefix + '_resources_requests_cpu', default=None) is not none %}
{{ ('k8s_' + service_prefix + '_resources_requests_cpu') | upper }}: {{ lookup('vars', 'k8s_' + service_prefix + '_resources_requests_cpu') }}
{%   endif %}
{%   if lookup('vars', 'k8s_' + service_prefix + '_resources_requests_memory', default=None) is not none %}
{{ ('k8s_' + service_prefix + '_resources_requests_memory') | upper }}: {{ lookup('vars', 'k8s_' + service_prefix + '_resources_requests_memory') }}
{%   endif %}
{%   if lookup('vars', 'k8s_' + service_prefix + '_resources_limits_cpu', default=None) is not none %}
{{ ('k8s_' + service_prefix + '_resources_limits_cpu') | upper }}: {{ lookup('vars', 'k8s_' + service_prefix + '_resources_limits_cpu') }}
{%   endif %}
{%   if lookup('vars', 'k8s_' + service_prefix + '_resources_limits_memory', default=None) is not none %}
{{ ('k8s_' + service_prefix + '_resources_limits_memory') | upper }}: {{ lookup('vars', 'k8s_' + service_prefix + '_resources_limits_memory') }}
{%   endif %}
{%- endmacro %}
{{ resource_block('lms') }}
{{ resource_block('cms') }}
# Add other services (forum, discovery, etc.) if needed:
# {{ resource_block('forum') }}

# MFE settings
{% if enable_mfe is defined and enable_mfe | bool %}
ENABLE_MFE: true
{% if mfe_learning_host is defined %}
MFE_LEARNING_HOST: {{ mfe_learning_host }}
{% endif %}
{% if mfe_course_authoring_host is defined %}
MFE_COURSE_AUTHORING_HOST: {{ mfe_course_authoring_host }}
{% endif %}
# Add other MFE hosts as needed
{% endif %}

# Add any other custom Tutor settings from inventory vars here
# Example:
# MY_CUSTOM_SETTING: {{ my_custom_setting_from_inventory | default('default_value') }}
